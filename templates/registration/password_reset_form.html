{% extends "base_generic.html" %}

{% block head %}
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="Mark Otto, Jacob Thornton, and Bootstrap contributors">
    <meta name="generator" content="Hugo 0.80.0">
    <title>Password reset Template · Bootstrap v5.0</title>


    {% load static %}
    <!-- Bootstrap core CSS -->
    <link rel="stylesheet" href="{% static 'css/bootstrap.min.css' %}">
    <!-- Custom styles for this template -->
    <link rel="stylesheet" href="{% static 'css/signin.css' %}">
    
  </head>
{% endblock %}


{% block body %}
<body class="container-fluid  text-white bg-dark text-center" >
    <main class="form-signin">
        <!--
        <form action="" method="post">{% csrf_token %}
            <img class="mb-4" src="{% static 'brand/logo.svg' %}" alt="" width="82" height="82">

            
            <h1 class="h3 mb-3 fw-normal">Introduce your email</h1>

            {% if form.email.errors %} {{ form.email.errors }} {% endif %}

            <p>{{ form.email }}</p>

            <button class="w-100 btn btn-lg btn-primary" type="submit"  value="Reset password" >Reset email</button>
            
            <p class="mt-5 mb-3 text-muted">&copy; 2020–2021</p>
            <p><a href="{% url 'login' %}">Log in?</a></p>
        </form>
-->

<img class="mb-4" src="{% static 'brand/logo.svg' %}" alt="" width="82" height="82">

<h1 class="h3 mb-3 fw-normal">Introduce your email:</h1>

<input type="text" id="id_mail" class="form-control" placeholder="User email" required autofocus name="useremail" value="" >

<button class="w-100 btn btn-lg btn-primary" type="submit"  value="Reset password" onclick="recoverpass()"  >Reset email</button>

<!--<a href="mailto:address..?subject=subject...&body=anything...&cc=ccemailaddress@something.com&bcc=bcc@something.com">
    <button id="btnOutlook">...</button>
</a>-->


<p class="mt-5 mb-3 text-muted">&copy; 2020–2021</p>
<p><a href="{% url 'login' %}">Log in?</a></p>

</main>


<script type="text/javascript">
function recoverpass(){

    console.log("recoverpass()")
    mail_to="alexandre.filgueira@seat.es"
    subject = "recover_pass_rpm";
    
    mail_user = document.getElementById("id_mail").value

    if (mail_user == null || mail_user == ""){
        alert("Need some email")
    }
    else{
        if (validateEmail(mail_user)) {
        body = "Solicito recupear la pass del usuario con mail: "+mail_user +  "        Pd: Te debo un café."
        window.location.href = "mailto:"+mail_to+"?body="+body+"&subject="+subject;
        }
        else{
            alert("The email format is invalid")
        }
    }
    
    //console.log("body:",body)
}

function validateEmail(email) {
    const re = /^(([^<>()[\]\\.,;:\s@"]+(\.[^<>()[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/;
    return re.test(String(email).toLowerCase());
}

</script> 
</body>


{% endblock %}